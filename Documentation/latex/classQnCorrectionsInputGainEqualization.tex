\hypertarget{classQnCorrectionsInputGainEqualization}{}\section{Qn\+Corrections\+Input\+Gain\+Equalization Class Reference}
\label{classQnCorrectionsInputGainEqualization}\index{Qn\+Corrections\+Input\+Gain\+Equalization@{Qn\+Corrections\+Input\+Gain\+Equalization}}


Encapsulates the gain equalization on input data correction step.  




{\ttfamily \#include $<$Gain\+Equalization.\+h$>$}



\subsection{Detailed Description}
Encapsulates the gain equalization on input data correction step. 

Gain equalization is applied on raw data from the involved detector. Two procedures are implemented\+: average gain equalization and width equalization.

The average gain equalization is applied for the signal $ \mbox{M}_{c,i} $ of each detector channel $ c $ measured for event $ i $ according to\+: \[ \mbox{M}'_{c,i} = \frac{\mbox{M}_{c,i}}{\langle\mbox{M}_{c}\rangle} \] where $\langle\mbox{M}_{c}\rangle$ is an average over events in a given event class \[ \langle\mbox{M}_{c}\rangle = \frac{1}{\mbox{N}_{ev}} \Sigma_{i}^{\mbox{N}_{ev}} \mbox{M}_{c,i} \]

The width equalization is applied for the signal $ \mbox{M}_{c,i} $ of each detector channel $ c $ measured for event $ i $ according to\+: \[ \mbox{M}'_{c,i} = \mbox{A} + \mbox{B} \frac{\mbox{M}_{c,i} - \langle\mbox{M}_{c}\rangle} {\sigma_{{M}_{c}}} \] with A and B are parameters that are the same for all channels and $\sigma_{{M}_{c}}$ is the standard deviation of the signals of the channel $c$ for the considered event class \[ \sigma_{{M}_{c}} = \sqrt{ \frac{1}{\mbox{N}_{ev}} \Sigma_{i}^{\mbox{N}_{ev}} \mbox{M}^2_{c,i} - \frac{1}{\mbox{N}^2_{ev}} \left(\Sigma_{i}^{\mbox{N}_{ev}} \mbox{M}_{c,i}\right)^2} \] At the class level A is known as the shift and B is known as the scale. The class also provides support for group equalization where a group weight can be extracted from the channels that conform a group or could be passed as hard coded group weights at detector configuration definition.

The gain equalization is only applied if the class instance is in the correction status. In order to be in that status the instance should have been able to get the proper calibration histograms that will provide the required averages per event class and channel. If the class instance is not in the correction status then, it is in the calibration one, collecting data for producing, once merged in a further phase, the calibration histograms. 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
D\+T\+\_\+\+Flow/\+Qn\+Corrections/include/Gain\+Equalization.\+h\end{DoxyCompactItemize}
